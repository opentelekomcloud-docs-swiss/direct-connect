:original_name: CreateVirtualGateway.html

.. _CreateVirtualGateway:

Creating a Virtual Gateway
==========================

Function
--------

This API is used to create a virtual gateway.

URI
---

POST /v3/{project_id}/dcaas/virtual-gateways

.. table:: **Table 1** Path parameters

   ========== ========= ====== =========================
   Parameter  Mandatory Type   Description
   ========== ========= ====== =========================
   project_id Yes       String Specifies the project ID.
   ========== ========= ====== =========================

Request Parameters
------------------

.. table:: **Table 2** Request header parameters

   +-----------------+-----------------+-----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                                                                                                                                                        |
   +=================+=================+=================+====================================================================================================================================================================================================================+
   | X-Auth-Token    | Yes             | String          | Specifies the user token. To obtain the token, see section "Obtaining the User Token" in the *Identity and Access Management API Reference*. The token is the value of **X-Subject-Token** in the response header. |
   |                 |                 |                 |                                                                                                                                                                                                                    |
   |                 |                 |                 | Minimum: **0**                                                                                                                                                                                                     |
   |                 |                 |                 |                                                                                                                                                                                                                    |
   |                 |                 |                 | Maximum: **10240**                                                                                                                                                                                                 |
   +-----------------+-----------------+-----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. table:: **Table 3** Request body parameters

   +-----------------+-----------+----------------------------------------------------------------------------------------------------------------------+----------------------------------------------+
   | Parameter       | Mandatory | Type                                                                                                                 | Description                                  |
   +=================+===========+======================================================================================================================+==============================================+
   | virtual_gateway | No        | :ref:`CreateVirtualGateway <createvirtualgateway__en-us_topic_0000001735666304_request_createvirtualgateway>` object | Specifies the virtual gateway to be created. |
   +-----------------+-----------+----------------------------------------------------------------------------------------------------------------------+----------------------------------------------+

.. _createvirtualgateway__en-us_topic_0000001735666304_request_createvirtualgateway:

.. table:: **Table 4** CreateVirtualGateway

   +-----------------------+-----------------+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Mandatory       | Type             | Description                                                                                                                                                                                     |
   +=======================+=================+==================+=================================================================================================================================================================================================+
   | vpc_id                | Yes             | String           | Specifies the ID of the VPC that the virtual gateway is associated with. This parameter is mandatory when a virtual gateway is used by a connection for accessing a VPC.                        |
   +-----------------------+-----------------+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | enterprise_router_id  | No              | String           | Specifies the ID of the enterprise router that the virtual gateway is attached to. This parameter is mandatory when a virtual gateway is attached to an enterprise router.                      |
   +-----------------------+-----------------+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | name                  | No              | String           | Specifies the virtual gateway name.                                                                                                                                                             |
   |                       |                 |                  |                                                                                                                                                                                                 |
   |                       |                 |                  | Minimum: **0**                                                                                                                                                                                  |
   |                       |                 |                  |                                                                                                                                                                                                 |
   |                       |                 |                  | Maximum: **64**                                                                                                                                                                                 |
   +-----------------------+-----------------+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | description           | No              | String           | Provides supplementary information about the virtual gateway.                                                                                                                                   |
   |                       |                 |                  |                                                                                                                                                                                                 |
   |                       |                 |                  | Minimum: **0**                                                                                                                                                                                  |
   |                       |                 |                  |                                                                                                                                                                                                 |
   |                       |                 |                  | Maximum: **128**                                                                                                                                                                                |
   +-----------------------+-----------------+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | local_ep_group        | Yes             | Array of strings | Specifies the IPv4 subnets of the associated VPC that can be accessed over the virtual gateway. This parameter is mandatory when a virtual gateway is used by a connection for accessing a VPC. |
   +-----------------------+-----------------+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | local_ep_group_ipv6   | No              | Array of strings | Specifies the IPv6 subnets of the associated VPC that can be accessed over the virtual gateway. This is a reserved field.                                                                       |
   +-----------------------+-----------------+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | bgp_asn               | No              | Integer          | Specifies the local BGP autonomous system number (ASN) of the virtual gateway.                                                                                                                  |
   |                       |                 |                  |                                                                                                                                                                                                 |
   |                       |                 |                  | Minimum: **1**                                                                                                                                                                                  |
   |                       |                 |                  |                                                                                                                                                                                                 |
   |                       |                 |                  | Maximum: **4294967295**                                                                                                                                                                         |
   +-----------------------+-----------------+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | enterprise_project_id | No              | String           | Specifies the ID of the enterprise project that the virtual gateway belongs to.                                                                                                                 |
   |                       |                 |                  |                                                                                                                                                                                                 |
   |                       |                 |                  | Minimum: **36**                                                                                                                                                                                 |
   |                       |                 |                  |                                                                                                                                                                                                 |
   |                       |                 |                  | Maximum: **36**                                                                                                                                                                                 |
   +-----------------------+-----------------+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Response Parameters
-------------------

**Status code: 201**

.. table:: **Table 5** Response body parameters

   +-----------------+-----------------------------------------------------------------------------------------------------------+--------------------------------+
   | Parameter       | Type                                                                                                      | Description                    |
   +=================+===========================================================================================================+================================+
   | virtual_gateway | :ref:`VirtualGateway <createvirtualgateway__en-us_topic_0000001735666304_response_virtualgateway>` object | Specifies the virtual gateway. |
   +-----------------+-----------------------------------------------------------------------------------------------------------+--------------------------------+
   | request_id      | String                                                                                                    | Specifies the request ID.      |
   +-----------------+-----------------------------------------------------------------------------------------------------------+--------------------------------+

.. _createvirtualgateway__en-us_topic_0000001735666304_response_virtualgateway:

.. table:: **Table 6** VirtualGateway

   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                  | Description                                                                                                                                                 |
   +=======================+=======================+=============================================================================================================================================================+
   | id                    | String                | Specifies the virtual gateway ID.                                                                                                                           |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | vpc_id                | String                | Specifies the ID of the VPC connected using the virtual gateway.                                                                                            |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | enterprise_router_id  | String                | Specifies the ID of the enterprise router that the virtual gateway is attached to.                                                                          |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | tenant_id             | String                | Specifies the project ID.                                                                                                                                   |
   |                       |                       |                                                                                                                                                             |
   |                       |                       | Minimum: **32**                                                                                                                                             |
   |                       |                       |                                                                                                                                                             |
   |                       |                       | Maximum: **32**                                                                                                                                             |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | name                  | String                | Specifies the virtual gateway name.                                                                                                                         |
   |                       |                       |                                                                                                                                                             |
   |                       |                       | Minimum: **0**                                                                                                                                              |
   |                       |                       |                                                                                                                                                             |
   |                       |                       | Maximum: **64**                                                                                                                                             |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | description           | String                | Provides supplementary information about the virtual gateway.                                                                                               |
   |                       |                       |                                                                                                                                                             |
   |                       |                       | Minimum: **0**                                                                                                                                              |
   |                       |                       |                                                                                                                                                             |
   |                       |                       | Maximum: **128**                                                                                                                                            |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | type                  | String                | Specifies the virtual gateway type. The value can only be **default**.                                                                                      |
   |                       |                       |                                                                                                                                                             |
   |                       |                       | Default: **default**                                                                                                                                        |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | local_ep_group        | Array of strings      | Specifies the IPv4 subnets of the associated VPC that can be accessed over the virtual gateway.                                                             |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | local_ep_group_ipv6   | Array of strings      | Specifies the IPv6 subnets of the associated VPC that can be accessed over the virtual gateway. This is a reserved field.                                   |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | admin_state_up        | Boolean               | Specifies the administrative status. The value can be **true** or **false**.                                                                                |
   |                       |                       |                                                                                                                                                             |
   |                       |                       | Default: **true**                                                                                                                                           |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | status                | String                | Specifies the operating status. The value can be **ACTIVE**, **DOWN**, **BUILD**, **ERROR**, **PENDING_CREATE**, **PENDING_UPDATE**, or **PENDING_DELETE**. |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | bgp_asn               | Integer               | Specifies the local BGP ASN of the virtual gateway.                                                                                                         |
   |                       |                       |                                                                                                                                                             |
   |                       |                       | Minimum: **1**                                                                                                                                              |
   |                       |                       |                                                                                                                                                             |
   |                       |                       | Maximum: **4294967295**                                                                                                                                     |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | enterprise_project_id | String                | Specifies the ID of the enterprise project that the virtual gateway belongs to.                                                                             |
   |                       |                       |                                                                                                                                                             |
   |                       |                       | Minimum: **36**                                                                                                                                             |
   |                       |                       |                                                                                                                                                             |
   |                       |                       | Maximum: **36**                                                                                                                                             |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | device_id             | String                | Specifies the ID of the device that the virtual interface belongs to.                                                                                       |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | redundant_device_id   | String                | Specifies the ID of the redundant device.                                                                                                                   |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | public_border_group   | String                | Specifies the public border group of the AZ, indicating whether the site is a HomeZones site. (This parameter is not supported currently.)                  |
   +-----------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+

Example Requests
----------------

-  Creating a virtual gateway that will be used to access a VPC, with the local BGP ASN set to 64512 and the IPv6 subnet to 1250:5:300c::/64

   .. code-block:: text

      POST https://{dc_endpoint}/v3/4bd6efdb0fb747b39aa2c0162c112226/dcaas/virtual-gateways

      {
          "virtual_gateway": {
              "name": "vgw-ec56",
              "description": "",
              "type": "default",
              "vpc_id": "e970dd53-c347-47da-a20e-8190282fc887",
              "enterprise_project_id": "0",
              "tags": [],
              "local_ep_group": [],
              "local_ep_group_ipv6": [
                  "1250:5:300c::/64"
              ]
          }
      }

Example Responses
-----------------

**Status code: 201**

Created

-  The virtual gateway for accessing the VPC is created

   .. code-block::

      {
          "virtual_gateway": {
              "enterprise_project_id": "0",
              "name": "vgw-ec56",
              "id": "aabd3b0b-c937-4fa0-a07b-b6fa5034aa3e",
              "description": "",
              "tenant_id": "4bd6efdb0fb747b39aa2c0162c112226",
              "vpc_id": "e970dd53-c347-47da-a20e-8190282fc887",
              "enterprise_router_id": null,
              "tags": [],
              "device_id": null,
              "redundant_device_id": null,
              "type": "default",
              "status": "ACTIVE",
              "admin_state_up": true,
              "bgp_asn": 64512,
              "local_ep_group": [],
              "local_ep_group_ipv6": [
                  "1250:5:300c::/64"
              ],
              "public_border_group": null
          },
          "request_id": "f97c27791c2700359b6f1c88120d43af"
      }

Status Codes
------------

=========== ===========
Status Code Description
=========== ===========
201         Created
=========== ===========

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
